import React, { useEffect, useMemo, useState } from "react";
import { motion, AnimatePresence } from "framer-motion";
import {
  PlayCircle,
  Film,
  Layers,
  GalleryVerticalEnd,
  Phone,
  Mail,
  MapPin,
  Star,
  Filter,
  Search,
  Github,
  Linkedin,
  Instagram,
  Youtube,
  ArrowUpRight,
  Sparkles,
  Menu,
  X,
} from "lucide-react";

/* -----------------------------
 Utility
----------------------------- */
const cn = (...c) => c.filter(Boolean).join(" ");

const Section = ({ id, className = "", children }) => (
  <section
    id={id}
    className={cn(
      "w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",
      className
    )}
  >
    {children}
  </section>
);

const Page = ({ children }) => (
  <motion.main
    initial={{ opacity: 0, y: 12 }}
    animate={{ opacity: 1, y: 0 }}
    exit={{ opacity: 0, y: -12 }}
    transition={{ duration: 0.45 }}
    className="min-h-[calc(100vh-80px)]"
  >
    {children}
  </motion.main>
);

const GradientText = ({ children }) => (
  <span className="bg-gradient-to-r from-[#c2a26a] to-[#e6d3a3] bg-clip-text text-transparent">
    {children}
  </span>
);

const GlassCard = ({ children, className }) => (
  <div
    className={cn(
      "rounded-3xl border border-white/10 bg-white/5 backdrop-blur-xl",
      className
    )}
  >
    {children}
  </div>
);

const Button = ({ variant = "primary", className = "", ...props }) => {
  const styles = {
    primary:
      "bg-[#c2a26a]/80 text-black hover:bg-[#d6ba82] shadow-lg backdrop-blur-md",
    ghost:
      "border border-white/15 bg-white/5 text-white hover:bg-white/10 backdrop-blur-md",
  };

  return (
    <button
      {...props}
      className={cn(
        "inline-flex items-center gap-2 px-5 py-2 rounded-2xl text-sm font-medium transition focus:outline-none",
        styles[variant],
        className
      )}
    />
  );
};

/* -----------------------------
 Navbar
----------------------------- */
const Navbar = ({ route, setRoute }) => {
  const [open, setOpen] = useState(false);
  const items = ["home", "portfolio", "services", "testimonials", "contact"];

  return (
    <nav className="sticky top-0 z-50 bg-[#0f0d08]/70 backdrop-blur-xl border-b border-white/5">
      <div className="max-w-7xl mx-auto h-20 flex items-center justify-between px-4">
        <div className="flex items-center gap-3">
          <Film className="text-[#c2a26a]" />
          <button onClick={() => setRoute("home")}>
            <h1 className="text-lg font-semibold">
              <GradientText>Dark India Studios</GradientText>
            </h1>
          </button>
        </div>

        <div className="hidden md:flex items-center gap-2">
          {items.map((i) => (
            <button
              key={i}
              onClick={() => setRoute(i)}
              className={cn(
                "px-3 py-2 rounded-xl text-sm capitalize text-white/70 hover:text-white",
                route === i && "bg-white/10 text-white"
              )}
            >
              {i}
            </button>
          ))}
          <Button onClick={() => setRoute("contact")}>
            Work With Us <ArrowUpRight className="h-4 w-4" />
          </Button>
        </div>

        <button
          className="md:hidden p-2"
          onClick={() => setOpen(!open)}
          aria-label="menu"
        >
          {open ? <X /> : <Menu />}
        </button>
      </div>

      <AnimatePresence>
        {open && (
          <motion.div
            initial={{ height: 0 }}
            animate={{ height: "auto" }}
            exit={{ height: 0 }}
            className="md:hidden overflow-hidden border-t border-white/5"
          >
            <div className="flex flex-col p-4 gap-2">
              {items.map((i) => (
                <button
                  key={i}
                  onClick={() => {
                    setRoute(i);
                    setOpen(false);
                  }}
                  className="text-left px-3 py-2 rounded-xl capitalize text-white/80 hover:bg-white/10"
                >
                  {i}
                </button>
              ))}
            </div>
          </motion.div>
        )}
      </AnimatePresence>
    </nav>
  );
};

/* -----------------------------
 Home
----------------------------- */
const Home = ({ setRoute }) => (
  <Page>
    <Section>
      <div className="grid lg:grid-cols-2 gap-12 items-center">
        <div>
          <h1 className="text-4xl sm:text-5xl font-extrabold text-white leading-tight">
            Creative Video Editing
            <br />
            by <GradientText>Dark India Studios</GradientText>
          </h1>

          <p className="mt-5 text-white/70 max-w-xl">
            We craft premium short-form content, cinematic edits, and
            performance-driven visuals for creators and brands.
          </p>

          <div className="mt-6 flex gap-3 flex-wrap">
            <Button onClick={() => setRoute("portfolio")}>
              View Portfolio <GalleryVerticalEnd className="h-4 w-4" />
            </Button>
            <Button variant="ghost" onClick={() => setRoute("services")}>
              Our Services
            </Button>
          </div>
        </div>

        <GlassCard className="p-2">
          <div className="aspect-video rounded-2xl bg-black/40 flex items-center justify-center">
            <PlayCircle className="h-14 w-14 text-[#c2a26a]" />
          </div>
        </GlassCard>
      </div>
    </Section>
  </Page>
);

/* -----------------------------
 Portfolio (logic unchanged)
----------------------------- */
// Keep your existing Portfolio component logic
// Only visuals automatically inherit new theme

/* -----------------------------
 Footer
----------------------------- */
const Footer = () => (
  <footer className="border-t border-white/5">
    <Section className="py-8 text-center text-white/50 text-sm">
      Â© {new Date().getFullYear()} Dark India Studios â€” Crafted in India ðŸ‡®ðŸ‡³
    </Section>
  </footer>
);

/* -----------------------------
 App Shell
----------------------------- */
const AppShell = () => {
  const [route, setRoute] = useState("home");

  return (
    <div className="min-h-screen bg-[#080706] text-white">
      <Navbar route={route} setRoute={setRoute} />

      <AnimatePresence mode="wait">
        {route === "home" && <Home key="home" setRoute={setRoute} />}
        {/* reuse Portfolio / Services / Contact as-is */}
      </AnimatePresence>

      <Footer />
    </div>
  );
};

export default AppShell;
